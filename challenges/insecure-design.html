<div class="challenge-content">
    <h2>Insecure Design Challenge</h2>
    <p>Exploit the race condition vulnerability to reveal the flag.</p>
    
    <div class="info-box">
        <strong>Challenge:</strong> The payment system has a race condition. Exploit it to purchase an item you cannot afford.
    </div>
    
    <h3>Payment System</h3>
    <div class="info-box">
        <p>Balance: <strong id="balance">100</strong> tokens</p>
        <p>Item cost: <strong>150</strong> tokens</p>
    </div>
    
    <div class="flag-submission" style="margin-top: 2rem;">
        <h3>Actions</h3>
        <button class="btn-submit" onclick="makePurchase()">Purchase Item (150 tokens)</button>
        <button class="btn-submit" onclick="checkFlag()" style="margin-left: 1rem;">Check Status</button>
        <div id="purchase-result" class="mt-2"></div>
        <div id="flag-reveal" class="hidden mt-2"></div>
    </div>
    
    <h3>Flag Submission</h3>
    <div class="flag-submission">
        <div class="flag-input-group">
            <input type="text" id="flag-input" placeholder="CTF{...}" />
            <button class="btn-submit" id="submit-flag-btn">Submit</button>
        </div>
        <div id="flag-result" class="hidden"></div>
    </div>
    
    <div class="hints-section">
        <h3>Hints</h3>
        <div class="hint-item">
            <button class="hint-toggle" onclick="toggleHint('hint-1')">
                Hint 1 <span id="hint-1-arrow">▼</span>
            </button>
            <div id="hint-1" class="hint-content hidden">
                The check and deduction are asynchronous with delays. If multiple checks complete in the window before any deduction, they all pass.
            </div>
        </div>
        <div class="hint-item">
            <button class="hint-toggle" onclick="toggleHint('hint-2')">
                Hint 2 <span id="hint-2-arrow">▼</span>
            </button>
            <div id="hint-2" class="hint-content hidden">
                Trigger multiple purchases rapidly. The race condition allows the balance to go negative or multiple transactions to queue. The flag appears when exploitation succeeds.
            </div>
        </div>
    </div>
</div>
